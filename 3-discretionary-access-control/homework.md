## Биты доступа
### Просмотр битов доступа и принадлежности файла
> Изучите права доступа __программы__ `passwd`. Объясните их смысл.

```bash
ls -l /usr/bin/passwd
# -rwsr-xr-x 1 root root 64152 May 30  2024 /usr/bin/passwd
```
`-` в самом начале означает, что это обычный файл.

`r` у всех секций означают, что владелец файла `root`, все кто в группе `root` и все остальные пользователи могут прочитать бинарник `passwd`.

`w` в начале означет, что владелец файла `root` может менять бинарник `passwd`.

`s` и последующие `x` означают, что у файла присутствует бит `SUID (Set User-ID)`, который при выполнении меняет эффективный `UID` у пользователя, запустившего программу, на `UID` владельца в нашем случае на `root`.
Это в свою очередь означает, что для выполнения программы не нужно повышение прав до `root` или какого-то другого пользователя и её может выполнить любой пользователь системы.

__Примечание__: если попробовать поставить неисполняемому файлу бит `SUID`, то в правах доступа будет заглавная `S`, что говорит о том, что `SUID` практически бесполезен, 
так как он чаще всего нужен для исполняемых файлов.

### Изменение прав доступа к файлам

> В командах ниже предполагается, что в системе существуют два пользователя: `ivan` (включен в `/etc/sudoers`)

```bash
sudo adduser ivan
sudo usermode -a -G sudo ivan
```
> и `polina` (не включена в `/etc/sudoers`).

```bash
sudo adduser polina
```

> Команды выполняются от лица пользователя `ivan`.

```bash
su - ivan
```

> Теперь сделайте так, чтобы `polina` смогла прочитать содержимое файла `file`.

Сколько не меняй права `file`, `polina` не сможет его прочитать, так как файл находится в домашней директории `ivan`, а это по определению такая директорию, в которой у владельца максимальные права, а у всех остальных нет никаких прав (за исключением `root`).

Поэтому надо добавить право на чтение файла для остальных и воспользоваться тем, 
что у Ивана есть права администратора и создать жёсткую ссылку в домашнем катологе Полины на исходный файл , тогда она сможет его прочитать и отследить все изменения.

```bash
chmod "o+r" file
sudo ln file /home/polina/file
sudo -u polina cat /home/polina/file
# This is secret!
```

> Сделайте так, чтобы файл `dir/file` мог прочитать только тот, кто знает о его существовании.

Задание сформулировано не очень хорошо, так как мы находимся в домашнем катологе `ivan` и прочитать файл может только `ivan`, `root` и пользователи, у которых есть права `sudo`. 

Но задача про другое, нужно оставить бит `x` у директории и убрать бит `r`, тогда содержимое директории посмотреть будет нельзя, а прочитать файл, если знаешь его название можно:

```bash
chmod 111 dir
ls -ld dir
# d--x--x--x 2 ivan ivan 4096 Mar 10 10:29 dir
ls -l dir
# ls: cannot open directory 'dir': Permission denied
cat dir/file
# File content.
```

### Задачи
> 17. При помощи команды `umask` задайте такую маску, чтобы при создании файла никто не имел к нему никакого доступа, кроме владельца. При создании нового файла (команда `touch file1`) права доступа данного файла будут следующими: `-rw-------`.

```bash
umask 166
touch file1
ls -l file1
# -rw------- 1 ivan ivan 0 Mar 10 13:28 file1
```
> 18. При помощи команды `umask` задайте такую маску, чтобы при создании файла все имели к данному файлу полный доступ. При создании нового файла (команда `touch file2`) права доступа данного файла будут следующими: `-rw-rw-rw-`.

```bash
umask 111
touch file2
ls -l file2
# -rw-rw-rw- 1 ivan ivan 0 Mar 10 13:30 file2
```

# Атрибуты файла
